Code from "Refactoring: Improving the Design of Existing Code" book